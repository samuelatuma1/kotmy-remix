import{a as y}from"/build/_shared/chunk-DLUBBNLS.js";import{a as C,b as D,c as _,d as w,e as I,f as T,g as F,h as k}from"/build/_shared/chunk-HYPIXEO2.js";import{a as S}from"/build/_shared/chunk-WFNSFFXI.js";import{a as c}from"/build/_shared/chunk-DU3ERRUZ.js";import{a as H}from"/build/_shared/chunk-EQOSR4CK.js";import{a as K,b as N}from"/build/_shared/chunk-DFX53F3J.js";import{b as V}from"/build/_shared/chunk-EHYIQE7U.js";import{a as L}from"/build/_shared/chunk-PAN7QPZK.js";import{a as m,b}from"/build/_shared/chunk-7ERNTC7H.js";import{a as P}from"/build/_shared/chunk-IXKRAC64.js";import{a as A}from"/build/_shared/chunk-G6RWU2BR.js";import{l as j,m as M,t as x}from"/build/_shared/chunk-SN2BHVXC.js";import{a as U,b as d}from"/build/_shared/chunk-653BTUZP.js";import{c as i}from"/build/_shared/chunk-W5DRAD4K.js";var s=i(d(),1);function R({contest:e,disabled:a}){let r=x();return(0,s.jsxs)(C,{children:[(0,s.jsx)(D,{disabled:a,title:"Delete contest",className:H("flex items-center justify-center border min-w-[32px] min-h-[32px] rounded-full border-red-500 bg-red-50 text-red-500",{"bg-slate-100 border-slate-400 text-slate-400 cursor-not-allowed":a}),children:(0,s.jsx)(b,{src:m.trashIcon,className:"w-3"})}),(0,s.jsxs)(w,{className:"bg-secondary p-0 gap-0",children:[(0,s.jsxs)(I,{children:[(0,s.jsxs)(F,{className:"p-4 flex gap-3",children:[(0,s.jsx)("div",{className:"size-11 rounded-full bg-orange-100 flex items-center justify-center",children:(0,s.jsx)(b,{src:m.questionIcon})}),(0,s.jsxs)("p",{children:[(0,s.jsx)("span",{className:"block",children:"Delete contest"}),(0,s.jsx)("span",{className:"font-normal text-base text-admin-pry",children:"Confirm the deletion of this contest"})]})]}),(0,s.jsxs)(k,{className:"border-y p-4",children:[(0,s.jsxs)("span",{className:"text-primary mb-2 block",children:["Are you sure you want to delete ",e.name," contest?"]}),(0,s.jsx)("span",{className:"text-admin-pry",children:"This action is irreversible and will permanently delete this contest."})]})]}),(0,s.jsx)(T,{className:"flex justify-end gap-6 p-4",children:(0,s.jsxs)(r.Form,{method:"post",children:[(0,s.jsx)("input",{type:"hidden",name:"contestId",value:e._id}),(0,s.jsx)(_,{type:"submit",name:"intent",value:"delete",className:"bg-red-500 px-10 py-2 rounded-md font-bold min-w-[90px] text-white",children:"Proceed"})]})})]})]})}var l=i(d(),1);function W({contest:e,disabled:a}){let r=x(),n=e.stages.toSorted((u,v)=>u.stage-v.stage).reduce((u,v,B,Q)=>(v.active&&!u[0]&&(u[0]=v,u[1]=Q.at(B+1)??null),u),[null,null]),p=e.stages.findIndex(u=>u.active),h=p!==-1&&p<e.stages.length-1,J=a||!n.at(0)||!n.at(1)||!h;return(0,l.jsxs)(C,{children:[(0,l.jsx)(D,{asChild:!0,children:(0,l.jsx)(y,{disabled:J,icon:m.doubleArrowRightIcon,className:"border-indigo-700 bg-indigo-100 text-indigo-700",title:"Migrate stage"})}),(0,l.jsxs)(w,{className:"bg-secondary p-0 gap-0",children:[(0,l.jsxs)(I,{children:[(0,l.jsxs)(F,{className:"p-4 flex gap-3",children:[(0,l.jsx)("div",{className:"size-11 rounded-full bg-orange-100 flex items-center justify-center",children:(0,l.jsx)(b,{src:m.questionIcon})}),(0,l.jsxs)("p",{children:[(0,l.jsx)("span",{className:"block",children:"Migrate stage"}),(0,l.jsx)("span",{className:"font-normal text-base text-admin-pry",children:"Confirm migration to the next stage"})]})]}),(0,l.jsx)(k,{className:"border-y p-4",children:(0,l.jsxs)("span",{className:"text-primary block",children:["This will migrate all safe contestants from stage ",n[0]?.stage," to stage ",n[1]?.stage,". Proceed?"]})})]}),(0,l.jsx)(T,{className:"flex justify-end gap-6 p-4",children:(0,l.jsxs)(r.Form,{method:"post",children:[(0,l.jsx)("input",{type:"hidden",name:"from",value:n[0]?._id}),(0,l.jsx)("input",{type:"hidden",name:"to",value:n[1]?._id}),(0,l.jsx)(_,{type:"submit",name:"intent",value:"migrate",className:"bg-accent px-10 py-2 rounded-md font-bold min-w-[90px] text-white",children:"Proceed"})]})})]})]})}var g=i(d(),1);function $({rowData:e}){let a=e.stages.find(p=>p.active||p.status==="ongoing")?._id??e.stages.toSorted((p,h)=>h.stage-p.stage).find(p=>p.status==="completed")?._id??e.stages.toSorted((p,h)=>p.stage-h.stage).at(0)?._id,r=a?`/admin/contests/${e.id}/${a}`:"",n=x();return(0,g.jsxs)("div",{className:"flex gap-4 items-center",children:[(0,g.jsx)(y,{icon:m.contestantsIcon,element:"link",to:r,"aria-disabled":!r,className:"border-green-500 bg-green-50 text-green-500",title:"View current stage"}),(0,g.jsx)(y,{icon:m.editIcon,element:"link",to:`/admin/contests/${e.id}`,className:"border-[#262626] bg-[#F7F7F8] text-primary",title:"Edit contest"}),(0,g.jsxs)(n.Form,{method:"post",children:[(0,g.jsx)("input",{type:"hidden",name:"contestId",value:e._id}),(0,g.jsx)(y,{icon:m.viewIcon,name:"intent",value:"toggle_registration",className:"border-yellow-700 bg-yellow-100 text-yellow-700","aria-disabled":n.state!="idle",title:"Open/Close registration"})]}),(0,g.jsx)(W,{contest:e}),(0,g.jsx)(R,{contest:e})]})}var q=i(U(),1);var z=i(A(),1);var O=i(A(),1);var f=i(d(),1);function E({grade:e}){let[a,[r,n]]=e;return(0,f.jsxs)("div",{className:"flex gap-2",children:[(0,f.jsxs)("div",{className:"flex flex-col",children:[(0,f.jsx)("span",{className:"block font-bold",children:"Grade"}),(0,f.jsx)("span",{className:(0,O.default)(`h-full w-[40px] px-2 py-1 flex items-center justify-center bg-grade-${a} rounded-md text-white font-black`),children:a})]}),(0,f.jsx)(c,{as:"input",id:`min_${a}`,name:`min_${a}`,labelText:"Min. Score",type:"number",min:0,defaultValue:r}),(0,f.jsx)(c,{as:"input",id:`max_${a}`,name:`max_${a}`,labelText:"Max. Score",type:"number",min:0,defaultValue:n})]})}var t=i(d(),1);function G({row:e}){let[a,r]=(0,q.useState)(e.original.stages[0]??null);return(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsx)("div",{className:"p-3 flex gap-2 border border-disabled bg-[#F6F8FA] rounded-md",children:e.original.stages.length?e.original.stages.map(n=>(0,t.jsxs)(S,{element:"button",variant:"outline",onClick:()=>r(n),className:(0,z.default)("px-5 py-1 text-xs text-admin-pry rounded-md",{"border-secondary bg-white":a?.stage===n.stage,"border-transparent":a?.stage!==n.stage}),children:["Stage ",n.stage]},n._id)):(0,t.jsx)("span",{children:"There are no stages."})}),a?(0,t.jsx)(X,{stage:a,contestId:e.original.id,closeForm:e.getToggleExpandedHandler()},a._id):null]})}function X({stage:e,contestId:a,closeForm:r}){return(0,t.jsxs)(M,{method:"POST",className:"text-primary text-xs flex flex-col gap-4",children:[(0,t.jsxs)("fieldset",{className:"py-4 grid grid-cols-4 gap-3 border-b",children:[(0,t.jsx)(c,{as:"input",id:"start_date",name:"start_date",labelText:"Stage Start Date",type:"datetime-local",defaultValue:V(e.start_date)}),(0,t.jsx)(c,{as:"input",id:"end_date",name:"end_date",labelText:"Stage End Date",type:"datetime-local",defaultValue:V(e.end_date)}),(0,t.jsx)(c,{as:"input",id:"weight",name:"weight",labelText:"Stage Weight (%)",type:"number",min:0,defaultValue:e.weight}),(0,t.jsx)(c,{as:"input",id:"success_count",name:"success_count",labelText:"Success Count",type:"number",min:0,defaultValue:e.success_count})]}),(0,t.jsxs)("fieldset",{className:"pt-2 pb-4 grid grid-cols-4 gap-3 border-b",children:[(0,t.jsxs)("legend",{className:"font-bold text-sm text-admin-pry w-max",children:["Stage Rates ",(0,t.jsx)("span",{className:"font-normal",children:"(must sum up to 100%)"})]}),(0,t.jsx)(c,{as:"input",id:"social_media_rate",name:"social_media_rate",labelText:"Social Media Rate (%)",type:"number",min:0,defaultValue:e.rates.social_media.amount}),(0,t.jsx)(c,{as:"input",id:"tally_rate",name:"tally_rate",labelText:"Tally Rate (%)",type:"number",min:0,defaultValue:e.rates.tally}),(0,t.jsx)(c,{as:"input",id:"givaah_rate",name:"givaah_rate",labelText:"Givaah Rate (%)",type:"number",min:0,defaultValue:e.rates.givaah}),(0,t.jsx)(c,{as:"input",id:"judge_rate",name:"judge_rate",labelText:"Judge Rate (%)",type:"number",min:0,defaultValue:e.rates.judge})]}),(0,t.jsxs)("fieldset",{className:"pt-2 py-4 grid grid-cols-2 gap-3 border-b",children:[(0,t.jsx)("legend",{className:"font-bold text-sm text-admin-pry",children:"Grades"}),Object.entries(e.grade).map(n=>(0,t.jsx)(E,{grade:n},n[0]))]}),(0,t.jsxs)("div",{className:"flex justify-between items-center gap-6",children:[(0,t.jsx)(j,{to:`${a}/${e._id}`,className:"text-accent hover:text-accent/80 font-semibold",children:"View contestants"}),(0,t.jsxs)("div",{className:"flex justify-end gap-6",children:[(0,t.jsx)(S,{element:"button",type:"button",variant:"outline",onClick:r,className:"px-3 py-2 rounded-md font-bold min-w-[90px] border-secondary hover:border-slate-400 text-primary",children:"Close Form"}),(0,t.jsx)(S,{element:"button",type:"submit",name:"intent",value:"update_stage",className:"px-3 py-2 rounded-md font-bold min-w-[90px] text-white",children:"Submit"})]})]}),(0,t.jsx)("input",{type:"hidden",name:"social_media_type",value:e.rates.social_media.type}),(0,t.jsx)("input",{type:"hidden",name:"stageId",value:e._id})]})}var o=i(d(),1),Y=[{id:"expander",header:()=>null,cell:({row:e})=>e.getCanExpand()?(0,o.jsx)("button",{title:"expand row",onClick:e.getToggleExpandedHandler(),children:(0,o.jsx)(b,{src:m.arrowDownIcon,className:e.getIsExpanded()?"rotate-180":""})}):null},{accessorKey:"id",header:({column:e})=>(0,o.jsx)(N,{column:e,title:"id"}),cell:({row:e})=>(0,o.jsx)("span",{className:"uppercase",children:e.getValue("id")})},{accessorKey:"name",header:({column:e})=>(0,o.jsx)(N,{column:e,title:"contest"}),cell:({row:e})=>(0,o.jsx)("span",{className:"uppercase line-clamp-1",children:e.getValue("name")})},{accessorKey:"timeline",header:({column:e})=>(0,o.jsx)(N,{column:e,title:"timeline"}),cell:({row:e})=>(0,o.jsxs)("p",{children:[(0,o.jsx)("span",{className:"block whitespace-nowrap",children:e.original.start_date.split(".")[0].replace("T",", ")}),(0,o.jsx)("span",{className:"block whitespace-nowrap",children:e.original.end_date.split(".")[0].replace("T",", ")})]})},{accessorKey:"status",header:({column:e})=>(0,o.jsx)(N,{column:e,title:"status"}),cell:({row:e})=>{let a=e.getValue("status").split("_").join(" ");return(0,o.jsx)(P,{status:a,color:a==="registering"?"yellow":a==="ongoing"?"green":a==="completed"?"red":"gray"})}},{id:"actions",header:"actions",cell:({row:e})=>(0,o.jsx)($,{rowData:e.original})}];function Z({data:e,pagination:a}){return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"w-full overflow-x-auto",children:(0,o.jsx)(K,{data:e,columns:Y,expandRows:!0,getRowCanExpand:()=>!0,SubComponent:G,className:"max-xs:text-xs text-sm"})}),a?(0,o.jsxs)("div",{className:"max-sm:flex-col max-xs:text-xs sm:w-4/5 mx-auto flex gap-2 justify-between items-center my-5",children:[(0,o.jsxs)("label",{className:"flex gap-2",children:["Rows per page",(0,o.jsx)("input",{type:"number",name:"rows",id:"rows",className:"w-10 pl-2 rounded-md border",defaultValue:10})]}),(0,o.jsx)(L,{})]}):null]})}export{Z as a};
